
Global batch 0, avg loss after 100 batches: 0.075  | Global batch 0, avg accuracy after 100 batches: 0.0



















Global batch 2000, avg loss after 100 batches: 7.414  | Global batch 2000, avg accuracy after 100 batches: 0.06.12 0.01



















Global batch 4000, avg loss after 100 batches: 6.805  | Global batch 4000, avg accuracy after 100 batches: 0.75.38 0.02



















Global batch 6000, avg loss after 100 batches: 6.298  | Global batch 6000, avg accuracy after 100 batches: 1.8888 0.165



















Global batch 8000, avg loss after 100 batches: 5.965  | Global batch 8000, avg accuracy after 100 batches: 3.44.81 0.43



















Global batch 10000, avg loss after 100 batches: 5.698  | Global batch 10000, avg accuracy after 100 batches: 5.252 0.64



















Global batch 12000, avg loss after 100 batches: 5.477  | Global batch 12000, avg accuracy after 100 batches: 7.8806 0.98



















Global batch 14000, avg loss after 100 batches: 5.243  | Global batch 14000, avg accuracy after 100 batches: 10.7588 1.75



















Global batch 16000, avg loss after 100 batches: 5.026  | Global batch 16000, avg accuracy after 100 batches: 14.190 2.529



















Global batch 18000, avg loss after 100 batches: 4.837  | Global batch 18000, avg accuracy after 100 batches: 16.2588 3.19



















Global batch 20000, avg loss after 100 batches: 4.707  | Global batch 20000, avg accuracy after 100 batches: 20.0662 6.02



















Global batch 22000, avg loss after 100 batches: 4.495  | Global batch 22000, avg accuracy after 100 batches: 24.8881 7.55



















Global batch 24000, avg loss after 100 batches: 4.341  | Global batch 24000, avg accuracy after 100 batches: 30.9469 10.05



















Global batch 26000, avg loss after 100 batches: 4.16  | Global batch 26000, avg accuracy after 100 batches: 34.75.19 14.88



















Global batch 28000, avg loss after 100 batches: 3.978  | Global batch 28000, avg accuracy after 100 batches: 39.0619 16.02



















Global batch 30000, avg loss after 100 batches: 3.853  | Global batch 30000, avg accuracy after 100 batches: 43.1244 18.97



















Global batch 32000, avg loss after 100 batches: 3.689  | Global batch 32000, avg accuracy after 100 batches: 48.060 25.342



















Global batch 34000, avg loss after 100 batches: 3.556  | Global batch 34000, avg accuracy after 100 batches: 49.8888 28.73



















Global batch 36000, avg loss after 100 batches: 3.398  | Global batch 36000, avg accuracy after 100 batches: 54.6919 35.52



















Global batch 38000, avg loss after 100 batches: 3.181  | Global batch 38000, avg accuracy after 100 batches: 62.9444 35.81



















Global batch 40000, avg loss after 100 batches: 3.054  | Global batch 40000, avg accuracy after 100 batches: 65.7506 42.36



















Global batch 42000, avg loss after 100 batches: 2.931  | Global batch 42000, avg accuracy after 100 batches: 67.3875 48.91



















Global batch 44000, avg loss after 100 batches: 2.79  | Global batch 44000, avg accuracy after 100 batches: 72.02.88 54.52



















Global batch 46000, avg loss after 100 batches: 2.603  | Global batch 46000, avg accuracy after 100 batches: 76.0.38 58.38



















Global batch 48000, avg loss after 100 batches: 2.464  | Global batch 48000, avg accuracy after 100 batches: 79.755 67.563



















Global batch 50000, avg loss after 100 batches: 2.328  | Global batch 50000, avg accuracy after 100 batches: 81.7538 67.44



















Global batch 52000, avg loss after 100 batches: 2.184  | Global batch 52000, avg accuracy after 100 batches: 83.5.25 72.01



















Global batch 54000, avg loss after 100 batches: 2.063  | Global batch 54000, avg accuracy after 100 batches: 84.4431 75.53



















Global batch 56000, avg loss after 100 batches: 1.91  | Global batch 56000, avg accuracy after 100 batches: 87.62.81 77.97



















Global batch 58000, avg loss after 100 batches: 1.792  | Global batch 58000, avg accuracy after 100 batches: 90.6906 85.16



















Global batch 60000, avg loss after 100 batches: 1.68  | Global batch 60000, avg accuracy after 100 batches: 90.56.12 83.59



















Global batch 62000, avg loss after 100 batches: 1.55  | Global batch 62000, avg accuracy after 100 batches: 92.52.12 85.39



















Global batch 64000, avg loss after 100 batches: 1.443  | Global batch 64000, avg accuracy after 100 batches: 93.5656 87.96



















Global batch 66000, avg loss after 100 batches: 1.306  | Global batch 66000, avg accuracy after 100 batches: 94.7556 89.75



















Global batch 68000, avg loss after 100 batches: 1.229  | Global batch 68000, avg accuracy after 100 batches: 95.560 92.514



















Global batch 70000, avg loss after 100 batches: 1.125  | Global batch 70000, avg accuracy after 100 batches: 96.2594 92.26



















Global batch 72000, avg loss after 100 batches: 1.026  | Global batch 72000, avg accuracy after 100 batches: 96.8125 94.88



















Global batch 74000, avg loss after 100 batches: 0.915  | Global batch 74000, avg accuracy after 100 batches: 97.6238 95.09



















Global batch 76000, avg loss after 100 batches: 0.868  | Global batch 76000, avg accuracy after 100 batches: 97.880 96.185



















Global batch 78000, avg loss after 100 batches: 0.75  | Global batch 78000, avg accuracy after 100 batches: 98.38.81 97.73



















Global batch 80000, avg loss after 100 batches: 0.675  | Global batch 80000, avg accuracy after 100 batches: 98.692 97.379



















Global batch 82000, avg loss after 100 batches: 0.629  | Global batch 82000, avg accuracy after 100 batches: 98.880 98.078



















Global batch 84000, avg loss after 100 batches: 0.546  | Global batch 84000, avg accuracy after 100 batches: 99.4431 98.67



















Global batch 86000, avg loss after 100 batches: 0.52  | Global batch 86000, avg accuracy after 100 batches: 99.25.12 98.33



















Global batch 88000, avg loss after 100 batches: 0.457  | Global batch 88000, avg accuracy after 100 batches: 99.4469 99.39



















Global batch 90000, avg loss after 100 batches: 0.406  | Global batch 90000, avg accuracy after 100 batches: 99.4475 99.52



















Global batch 92000, avg loss after 100 batches: 0.366  | Global batch 92000, avg accuracy after 100 batches: 99.1238 98.87



















Global batch 94000, avg loss after 100 batches: 0.33  | Global batch 94000, avg accuracy after 100 batches: 99.25.56 99.15



















Global batch 96000, avg loss after 100 batches: 0.304  | Global batch 96000, avg accuracy after 100 batches: 99.38 99.3952



















Global batch 98000, avg loss after 100 batches: 0.269  | Global batch 98000, avg accuracy after 100 batches: 99.6944 98.92



















Global batch 100000, avg loss after 100 batches: 0.24  | Global batch 100000, avg accuracy after 100 batches: 99.759 99.39







Global batch 100800, avg loss after 100 batches: 0.237  | avg accuracy (total, from_support) after 100 batches: 99.75 99.52
Traceback (most recent call last):
  File "/usr/project/xtmp/yz705/ICL-Experiments/./experiment.py", line 72, in <module>
  File "/usr/project/xtmp/yz705/ICL-Experiments/./experiment.py", line 61, in experiment_base
    )
  File "/usr/project/xtmp/yz705/ICL-Experiments/train.py", line 123, in train
    preds = self.model(examples, labels).transpose(1, 2)
  File "/home/users/yz705/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/users/yz705/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/project/xtmp/yz705/ICL-Experiments/models/transformer.py", line 231, in forward
    x = self.input_embedder(examples, labels, is_training).to(self.device)
  File "/home/users/yz705/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/users/yz705/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/project/xtmp/yz705/ICL-Experiments/models/embedding.py", line 153, in forward
    h_example = self.resnet(examples)
  File "/home/users/yz705/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/users/yz705/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/project/xtmp/yz705/ICL-Experiments/models/embedding.py", line 16, in forward
    return torch.stack([self.function(x[i]) for i in range(batch_size)])
  File "/usr/project/xtmp/yz705/ICL-Experiments/models/embedding.py", line 16, in <listcomp>
    return torch.stack([self.function(x[i]) for i in range(batch_size)])
  File "/home/users/yz705/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/users/yz705/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/project/xtmp/yz705/ICL-Experiments/models/resnet.py", line 64, in forward
    z = self.layer2(z)
  File "/home/users/yz705/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/users/yz705/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/users/yz705/.local/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/users/yz705/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/users/yz705/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/users/yz705/.local/lib/python3.10/site-packages/torchvision/models/resnet.py", line 97, in forward
    out = self.bn2(out)
  File "/home/users/yz705/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/users/yz705/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/users/yz705/.local/lib/python3.10/site-packages/torch/nn/modules/batchnorm.py", line 155, in forward
    self.num_batches_tracked.add_(1)  # type: ignore[has-type]
KeyboardInterrupt
Traceback (most recent call last):
  File "/usr/project/xtmp/yz705/ICL-Experiments/./experiment.py", line 72, in <module>
  File "/usr/project/xtmp/yz705/ICL-Experiments/./experiment.py", line 61, in experiment_base
    )
  File "/usr/project/xtmp/yz705/ICL-Experiments/train.py", line 123, in train
    preds = self.model(examples, labels).transpose(1, 2)
  File "/home/users/yz705/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/users/yz705/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/project/xtmp/yz705/ICL-Experiments/models/transformer.py", line 231, in forward
    x = self.input_embedder(examples, labels, is_training).to(self.device)
  File "/home/users/yz705/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/users/yz705/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/project/xtmp/yz705/ICL-Experiments/models/embedding.py", line 153, in forward
    h_example = self.resnet(examples)
  File "/home/users/yz705/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/users/yz705/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/project/xtmp/yz705/ICL-Experiments/models/embedding.py", line 16, in forward
    return torch.stack([self.function(x[i]) for i in range(batch_size)])
  File "/usr/project/xtmp/yz705/ICL-Experiments/models/embedding.py", line 16, in <listcomp>
    return torch.stack([self.function(x[i]) for i in range(batch_size)])
  File "/home/users/yz705/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/users/yz705/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/project/xtmp/yz705/ICL-Experiments/models/resnet.py", line 64, in forward
    z = self.layer2(z)
  File "/home/users/yz705/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/users/yz705/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/users/yz705/.local/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/users/yz705/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/users/yz705/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/users/yz705/.local/lib/python3.10/site-packages/torchvision/models/resnet.py", line 97, in forward
    out = self.bn2(out)
  File "/home/users/yz705/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/users/yz705/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/users/yz705/.local/lib/python3.10/site-packages/torch/nn/modules/batchnorm.py", line 155, in forward
    self.num_batches_tracked.add_(1)  # type: ignore[has-type]
KeyboardInterrupt